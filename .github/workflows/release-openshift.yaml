name: Release Openshift
on:
  push:
    branches:
      - CLOUDP-143633-automate-opnshift-release
  workflow_dispatch:
    inputs:
      version:
        description: "Release version:"
        required: true
jobs:
  release-openshift:
    name: "Create Pull request for openshift release"
    runs-on: ubuntu-latest
    env:
      GH_TOKEN: ${{ github.token }}
    strategy:
      matrix:
        repository: ["k8s-operatorhub/community-operators"] # , "redhat-openshift-ecosystem/community-operators-prod"]
        include:
          - repository: "k8s-operatorhub/community-operators"
            certified: false
          #- repository: "redhat-openshift-ecosystem/community-operators-prod"
          #  certified: false
          #- repository: git@github.com:mongodb-forks/certified-operators.git
          #  certified: true
    steps:
      - name: Check out code
        uses: actions/checkout@v3.1.0
        with:
          fetch-depth: 0
      - name: Create pull requests
        uses: ./.github/actions/openshift-release
        with:
          VERSION: ${{ github.event.inputs.version }}
          REPOSITORY: "${{ matrix.repository }}"
          CERTIFIED: "${{ matrix.certified }}"
          ASSIGNEES: "priyolahiri,fabritsius,igor-karpukhin,sugar-pack,helderjs"
